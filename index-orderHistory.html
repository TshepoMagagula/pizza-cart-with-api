<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historical Orders</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script src="//unpkg.com/alpinejs" defer></script>
    <script src="pizza.js"></script>
    <script src="https://unpkg.com/axios@1.1.2/dist/axios.min.js"></script>
</head>
<body style="background-color: black; text-align: center;">
    <Section x-data="pizzaCartWithAPIWidget">
        <Section class="header" style="text-align: left;">
            <ul style="float: right;">
                <li><a href="index.html">Home</a></li>
            </ul>
            <img src="./images/logo.jpg"
            style="float: left; border-radius: 4em;
            height: 9em; padding: 0.5em; margin-bottom: 1em;">
            <h1>PerfectPizza</h1>
            <span style="color: white; font-style: italic;">est. 2023</span>
        </Section>
    
        <section class="main">
            <h1>ORDER HISTORY</h1>
            <button @click="historyPizzas()">View Order History</button>
            <div x-show="displayHistory">
                <template x-for="cart in historyCartsIds">
                    <div x-init="getPastOrders(cart.cart_code)"></div>
                </template>
                <div>
                    <div x-show="pastOrderedPizzas.length === 0">
                        <h1><span>You have no previous orders</span></h1>
                    </div>
                    <template x-for="pizzaOrder in pastOrderedPizzas">
                        <div>
                            <div>
                                <table class="receipt">
                                    <thead>
                                        <tr>
                                            <th colspan="5">
                                                <h4>Receipt ID: <span x-text="pizzaOrder.cartId"></span></h4>
                                            </th>
                                        </tr>
                                        <tr>
                                            <th>Flavour</th>
                                            <th>Size</th>
                                            <th>Price</th>
                                            <th>Qty</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <template x-for="pizza in pizzaOrder.pizzas">
                                            <tr>
                                                <td x-text="pizza.flavour"></td>
                                                <td x-text="pizza.size"></td>
                                                <td x-text="pizza.price"></td>
                                                <td x-text="pizza.qty"></td>
                                                <td x-text="pizza.total.toFixe(2)"></td>
                                            </tr>
                                        </template>
                                        <tr>
                                            <td colspan="4">Total</td>
                                            <td>R<span x-text="pizzaOrder.total.toFixe(2)"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </section>
    </Section>
</body>
</html>